###########################################################################
#
# This is the additional jtreg exclude list for SapMachine hotspot tests.
#
# List of tests that should not be run by test/Makefile, for various reasons:
#   1. Does not run with jtreg -samevm mode
#   2. Causes problems in jtreg -samevm mode for jtreg or tests that follow it
#   3. The test is too slow or consumes too many system resources
#   4. The test fails when run on any official build systems
#
# Tests marked @ignore are not run by test/Makefile, but harmless to be listed.
#
# List items are testnames followed by labels, all MUST BE commented
#   as to why they are here and use a label:
#     generic-all   Problems on all platforms
#     generic-ARCH  Where ARCH is one of: sparc, sparcv9, x64, i586, ppc64,
#                   ppc64le, s390x etc
#     OSNAME-all    Where OSNAME is one of: solaris, linux, windows, macosx, aix
#     OSNAME-ARCH   Specific on to one OSNAME and ARCH, e.g. solaris-amd64
#     OSNAME-REV    Specific on to one OSNAME and REV, e.g. solaris-5.8
#
# More than one label is allowed but must be on the same line comma seperated,
# without spaces!
# If there are several lines, the last one is used.
#

#############################################################################
# Tests known to be failing in OpenJDK when jdk 11 was delivered (9/2018)

# SapMachine 2016-01-12
# Exclude because it occured the test crashed some server (...) by consuming too much memory.
compiler/compilercontrol/jcmd/StressAddMultiThreadedTest.java                      generic-all

# SapMachine 2015-12-08
# -XX:-UseSIGTRAP -XX:-TransmitErrorReport -XX:-CreateCoredumpOnCrash -XX:ErrorHandlerTest=13
# does not go through the signal handler.
# SapMachine 2017-07-21 Still fails.
# Opened bug for this:
# 8219916: [ppc64le] runtime/ErrorHandling/ErrorHandler.java fails on linux ppc64le
# Fixed by Gustavo in 13 and 11.0.4.
runtime/ErrorHandling/ErrorHandler.java                                            linux-ppc64le

# SapMachine 2016-06-07
# This is a linux error: https://lists.ozlabs.org/pipermail/linuxppc-dev/2016-January/138296.html
# Gustavo Romero is fixing this.
runtime/StackGuardPages/testme.sh                                                  linux-ppc64le,linux-ppc64

# SapMachine 2018-04-27
# These fail on windows for quite a while.
# RuntimeException: Unexpected exit code for positive case: []: expected 127 to equal 0
# SapMachine 2019-02-07 Still failing in 12.
# Fixed in 11.0.3 and 13 by:
# 8219651: compiler/ciReplay/TestServerVM.java is failing on windows
compiler/ciReplay/TestServerVM.java                                                windows-all
compiler/ciReplay/TestVMNoCompLevel.java                                           windows-all

# SapMachine 2018-06-22
# Needs to be fixed, backlog item exists.
# Was downported for jdk11.0.3: "8211931: [ppc][testbug] runtime/jni/terminatedThread/TestTerminatedThread.java fails as ..."
# Aix still failing.
# Opened bug for this:
# 8219652: [aix] Tests failing with attach problems.
runtime/jni/terminatedThread/TestTerminatedThread.java                             aix-ppc64

# SapMachine 2018-08-22, 2019-03-07
# Failing as of today, and ever before.
vmTestbase/nsk/jvmti/unit/functions/AddToBootstrapClassLoaderSearch/JvmtiTest/TestDescription.java windows-all

# SapMachine 2018-08-22, 2019-01-xx
# Failing as of today, and ever before.
# TEST FAILURE: AttachCurrentThread() returns: -1
# Opened bug for this:
# 8219652: [aix] Tests failing with attach problems.
vmTestbase/nsk/jvmti/scenarios/jni_interception/JI05/ji05t001/TestDescription.java aix-ppc64
vmTestbase/nsk/jvmti/scenarios/jni_interception/JI06/ji06t001/TestDescription.java aix-ppc64
vmTestbase/nsk/jvmti/SetJNIFunctionTable/setjniftab001/TestDescription.java        aix-ppc64

###############################################################################
# New failures detected after GA or caused by changes pushed after GA of jdk11.

# SapMachine 2019-03-11
# Fails with timeout or "Could not find any processes matching : 'HelpTest$Process'"
# We also see this in jdk13.
serviceability/dcmd/framework/HelpTest.java                                        generic-all

# SapMachine 2019-04-29
# Times out since 28.2.19, which is probably the date we started to run these again.
vmTestbase/vm/mlvm/cp/stress/classfmt/mh/TestDescription.java                      generic-all
vmTestbase/nsk/jvmti/GarbageCollectionStart/gcstart001/TestDescription.java        windows-x64

# SapMachine 2019-04-29
# java.lang.IllegalStateException: WB_IncMetaspaceCapacityUntilGC: could not increase capacity until GC due to contention with another thread
gc/metaspace/TestCapacityUntilGCWrapAround.java                                    windows-i586

# SapMachine 2019-04-29
# Fails regularly since 7.3.2019.
# java.io.EOFException: Trying to read at 25069488304625, but file is only 75896 bytes.
runtime/appcds/CDSandJFR.java                                                      windows-i586

# SapMachine 2019-02-13 Sporadic timeouts everywhere
# SapMachine 2019-04-29
# Timeout: Seen sporadic on various platforms and Java versions.
vmTestbase/nsk/jdi/EventRequestManager/createStepRequest/crstepreq001/TestDescription.java generic-all

# SapMachine 2019-04-29
# Sporadic timeout 11 only since 3.3.2019, which is probably the date we started to run these again. 
vmTestbase/nsk/jdb/unwatch/unwatch002/unwatch002.java                               generic-all

# SapMachine 2019-04-29
# Very sporadic on linux/ppc and 11 only.
# Can't attach to the process: ptrace(PTRACE_ATTACH, ..) failed for 4253: No such process
serviceability/sa/TestJhsdbJstackMixed.java                                         linux-ppc64le,linux-ppc64

##############################################################################
# Tests known to be failing in OpenJDK 12 when it was released (3/2019)

# SapMachine 2018-11-08

# Failing as of today: RuntimeException: The size computed by SA for java.lang.Object does not match.
# SapMachine 2019-02-07 still failing on ntamd64, linuxx86_64, linuxxppc64 ... but not all.
serviceability/sa/TestInstanceKlassSize.java                                8193639 generic-all
# Sporatic timeouts only on linuxppc64.
serviceability/sa/TestJmapCoreMetaspace.java                                        linux-ppc64

# SapMachine 2019-02-08
runtime/CompressedOops/UseCompressedOops.java                                       windows-all

# SapMachine 20190-02-08
# assert(!bucket->have_redirect() && !bucket->is_locked()). Seems to be a C++
# compiler issue, Martin tried to track this down, but we gave up on this.
# The test does not fail with xlC 16, so we need not exclude it in jdk 13+ which
# we build with the new compiler.
gtest/GTestWrapper.java                                                             aix-all

# SapMachine 2018-12-11, 2019-02-08
# java.lang.OutOfMemoryError: Java heap space
gc/shenandoah/TestStringDedupStress.java                                            macosx-all,linux-x64
# SapMachine 2019-01-08
# More Shenandoah failures.
gc/arguments/TestUseCompressedOopsErgo.java                                         windows-all
gc/arguments/TestUseCompressedOopsErgo.java#id2                                     windows-all
gc/metaspace/TestMetaspacePerfCounters.java                                         windows-all
gc/metaspace/TestMetaspacePerfCounters.java#id1                                     windows-all
gc/shenandoah/compiler/TestReferenceCAS.java                                        windows-all
gc/shenandoah/oom/TestClassLoaderLeak.java                                          windows-all
# Fails sporadically:
# RuntimeException: Total aborts count (1002) should be less or equal to 1001: expected that 1002 <= 1001
compiler/rtm/locking/TestRTMSpinLoopCount.java                                      generic-ppc64,linux-ppc64le
# Could not reserve enough space for 131072KB object heap
gc/shenandoah/jvmti/TestHeapDump.java                                               windows-all
# fatal error: Safepoint sync time longer than 10000ms detected when executing Cleanup.
gc/shenandoah/TestVerifyJCStress.java                                               windows-all
# fatal error: Safepoint sync time longer than 10000ms detected when executing ShenandoahInitMark.
gc/shenandoah/TestRegionSampling.java                                               windows-all

###############################################################################
# New failures detected after GA or caused by changes pushed after GA of jdk12.

# SapMachine 2019-04-29
#
gtest/GTestWrapper.java                                                                          linux-s390x

# SapMachine 2019-04-29
# Crash!!
# java.util.Arrays.copyOf: SIGILL (0x4) at pc=0x000000010ff87445, pid=853, tid=25603
gc/shenandoah/TestWithLogLevel.java                                                              macosx-all

# SapMachine 2019-04-29
# sporadic timeouts in 12 and 13.
runtime/ErrorHandling/TestHeapDumpOnOutOfMemoryErrorInMetaspace.java                             generic-ppc64

#############################################################################
# Tests known to be failing in SapMachine due to SapMachine specific setup.

# SapMachine 2018-10-05
# This test fails, because we do not have debug symbols available in all tests.
runtime/NMT/CheckForProperDetailStackTrace.java                                    generic-all

# SapMachine 2019-01-30 These tests fail for some reason on linux-ppc64le and linux-ppc64. Need to investigate.
gc/g1/humongousObjects/TestHumongousClassLoader.java                               linux-ppc64le,linux-ppc64
gc/g1/humongousObjects/TestHumongousNonArrayAllocation.java                        linux-ppc64le,linux-ppc64

# SapMachine 2019-01-31 These fail on Windows in the SapMachine CI infrastructure.
# We don't run them on OpenJDK as there we configure without aot.
# Need to check how this can be fixed.
compiler/aot/DeoptimizationTest.java                                               windows-all
compiler/aot/RecompilationTest.java                                                windows-all
compiler/aot/SharedUsageTest.java                                                  windows-all
compiler/aot/calls/fromAot/AotInvokeDynamic2AotTest.java                           windows-all
compiler/aot/calls/fromAot/AotInvokeDynamic2CompiledTest.java                      windows-all
compiler/aot/calls/fromAot/AotInvokeDynamic2InterpretedTest.java                   windows-all
compiler/aot/calls/fromAot/AotInvokeDynamic2NativeTest.java                        windows-all
compiler/aot/calls/fromAot/AotInvokeInterface2AotTest.java                         windows-all
compiler/aot/calls/fromAot/AotInvokeInterface2CompiledTest.java                    windows-all
compiler/aot/calls/fromAot/AotInvokeInterface2InterpretedTest.java                 windows-all
compiler/aot/calls/fromAot/AotInvokeInterface2NativeTest.java                      windows-all
compiler/aot/calls/fromAot/AotInvokeSpecial2AotTest.java                           windows-all
compiler/aot/calls/fromAot/AotInvokeSpecial2CompiledTest.java                      windows-all
compiler/aot/calls/fromAot/AotInvokeSpecial2InterpretedTest.java                   windows-all
compiler/aot/calls/fromAot/AotInvokeSpecial2NativeTest.java                        windows-all
compiler/aot/calls/fromAot/AotInvokeStatic2AotTest.java                            windows-all
compiler/aot/calls/fromAot/AotInvokeStatic2CompiledTest.java                       windows-all
compiler/aot/calls/fromAot/AotInvokeStatic2InterpretedTest.java                    windows-all
compiler/aot/calls/fromAot/AotInvokeStatic2NativeTest.java                         windows-all
compiler/aot/calls/fromAot/AotInvokeVirtual2AotTest.java                           windows-all
compiler/aot/calls/fromAot/AotInvokeVirtual2CompiledTest.java                      windows-all
compiler/aot/calls/fromAot/AotInvokeVirtual2InterpretedTest.java                   windows-all
compiler/aot/calls/fromAot/AotInvokeVirtual2NativeTest.java                        windows-all
compiler/aot/calls/fromCompiled/CompiledInvokeDynamic2AotTest.java                 windows-all
compiler/aot/calls/fromCompiled/CompiledInvokeInterface2AotTest.java               windows-all
compiler/aot/calls/fromCompiled/CompiledInvokeSpecial2AotTest.java                 windows-all
compiler/aot/calls/fromCompiled/CompiledInvokeStatic2AotTest.java                  windows-all
compiler/aot/calls/fromCompiled/CompiledInvokeVirtual2AotTest.java                 windows-all
compiler/aot/calls/fromInterpreted/InterpretedInvokeDynamic2AotTest.java           windows-all
compiler/aot/calls/fromInterpreted/InterpretedInvokeInterface2AotTest.java         windows-all
compiler/aot/calls/fromInterpreted/InterpretedInvokeSpecial2AotTest.java           windows-all
compiler/aot/calls/fromInterpreted/InterpretedInvokeStatic2AotTest.java            windows-all
compiler/aot/calls/fromInterpreted/InterpretedInvokeVirtual2AotTest.java           windows-all
compiler/aot/calls/fromNative/NativeInvokeSpecial2AotTest.java                     windows-all
compiler/aot/calls/fromNative/NativeInvokeStatic2AotTest.java                      windows-all
compiler/aot/calls/fromNative/NativeInvokeVirtual2AotTest.java                     windows-all
compiler/aot/cli/DisabledAOTWithLibraryTest.java                                   windows-all
compiler/aot/cli/MultipleAOTLibraryTest.java                                       windows-all
compiler/aot/cli/SingleAOTLibraryTest.java                                         windows-all
compiler/aot/cli/SingleAOTOptionTest.java                                          windows-all
compiler/aot/cli/jaotc/AtFileTest.java                                             windows-all
compiler/aot/cli/jaotc/CompileClassTest.java                                       windows-all
compiler/aot/cli/jaotc/CompileClassWithDebugTest.java                              windows-all
compiler/aot/cli/jaotc/CompileDirectoryTest.java                                   windows-all
compiler/aot/cli/jaotc/CompileJarTest.java                                         windows-all
compiler/aot/cli/jaotc/CompileModuleTest.java                                      windows-all
compiler/aot/cli/jaotc/IgnoreErrorsTest.java                                       windows-all
compiler/aot/cli/jaotc/ListOptionTest.java                                         windows-all
compiler/aot/cli/jaotc/ListOptionWrongFileTest.java                                windows-all
compiler/aot/fingerprint/SelfChanged.java                                          windows-all
compiler/aot/fingerprint/SelfChangedCDS.java                                       windows-all
compiler/aot/fingerprint/SuperChanged.java                                         windows-all
compiler/aot/verification/ClassAndLibraryNotMatchTest.java                         windows-all
compiler/aot/verification/vmflags/NotTrackedFlagTest.java                          windows-all
compiler/aot/verification/vmflags/TrackedFlagTest.java                             windows-all

# SapMachine 2019-01-31
# This test failed on linux-ppc64. Check if this still happens. Maybe intermittent?
runtime/jni/checked/TestCheckedEnsureLocalCapacity.java                            linux-ppc64
