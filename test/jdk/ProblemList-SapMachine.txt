###############################################################################
#
# This is the additional jtreg exclude list for SapMachine jdk tests.
#
# List of tests that should not be run by test/Makefile, for various reasons:
#   1. Does not run with jtreg -samevm mode
#   2. Causes problems in jtreg -samevm mode for jtreg or tests that follow it
#   3. The test is too slow or consumes too many system resources
#   4. The test fails when run on any official build systems
#
# Tests marked @ignore are not run by test/Makefile, but harmless to be listed.
#
# List items are testnames followed by labels, all MUST BE commented
#   as to why they are here and use a label:
#     generic-all   Problems on all platforms
#     generic-ARCH  Where ARCH is one of: sparc, sparcv9, x64, i586, ppc64,
#                   ppc64le, s390x etc
#     OSNAME-all    Where OSNAME is one of: solaris, linux, windows, macosx, aix
#     OSNAME-ARCH   Specific on to one OSNAME and ARCH, e.g. solaris-amd64
#     OSNAME-REV    Specific on to one OSNAME and REV, e.g. solaris-5.8
#
# More than one label is allowed but must be on the same line comma seperated,
# without spaces!
# If there are several lines, the last one is used.
#
# SAP/SapMachine usage notes:
#
# This exclude list should be a vehicle only for temporary exclusions of tests
# or exclusions that are caused by infrastrucure specifics.
#
# Our first goal should be to fix test issues upstream or at least open
# upstream bugs and get the test excluded via the upstream exclusion lists.
#
# We have both internal exclude lists and exclude lists in the SapMachine
# repository. The internal lists are the master and the public lists in the
# SapMachine repository will be refreshed regularly, removing comments
# which reveal internal URLs, names or hostnames.
#
# The public SapMachine exclusion lists might contain additional test
# exclusions, specific to the SapMachine build and test infrastructure. That
# section needs to be placed at the end of the file.
#
###############################################################################

###############################################################################
# Tests known to be failing in OpenJDK when JDK 11 was released (9/2018)

# SapMachine 2018-07-04, 2019-04-30
# Windows: Testbug: users mixed up by our infrastructure
# Aix: also in central exclude list, see 8211847.
#
# SapMachine 2019-07-16 Still fails
java/lang/ProcessHandle/InfoTest.java                                                windows-all,aix-all

# SapMachine 2018-08-22 Failures on sparc/linuxppc64le.
# Some just fail sporadic.
#
com/sun/nio/sctp/SctpChannel/Bind.java                                               solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/Receive.java                                            solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/ReceiveIntoDirect.java                                  solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/Shutdown.java                                           solaris-sparcv9
#
com/sun/nio/sctp/SctpServerChannel/Accept.java                                       solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/CommUp.java                                             solaris-sparcv9
#
com/sun/nio/sctp/SctpServerChannel/NonBlockingAccept.java                            solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/Connect.java                                            solaris-sparcv9
#
com/sun/nio/sctp/SctpMultiChannel/Branch.java                                        linux-ppc64le,solaris-sparcv9
#
com/sun/nio/sctp/SctpMultiChannel/SocketOptionTests.java                             linux-ppc64le,solaris-sparcv9
#
com/sun/nio/sctp/SctpMultiChannel/Send.java                                          linux-ppc64le,solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/SocketOptionTests.java                                  linux-ppc64le,solaris-sparcv9
#
com/sun/nio/sctp/SctpChannel/Send.java                                               linux-ppc64le,solaris-sparcv9
# SapMachine 2019-09-18 See if these still occur
#com/sun/nio/sctp/SctpChannel/Branch.java                                             solaris-sparcv9

# SapMachine 2018-06-22, 2019-04-30
# Fails only on recent Suse systems (e.g. SLES 12.2, 12.4, 15): "RuntimeException: Test failed for angle 15.0"
# The test passes on SLES 12.0, SLES 11.3, RHEL 6.1
#
# Opened bug for this: 8219641: java/awt/font/Rotate/RotatedTextTest.java fails on linux x86_64: Test failed for angle 15.0
java/awt/font/Rotate/RotatedTextTest.java                                    8219641 linux-all

# SapMachine 2019-09-26
# This seems to fail on RHEL 7: java.lang.RuntimeException: Font metrics differ for angle 165
#
java/awt/font/Rotate/RotatedFontMetricsTest.java                                     linux-all

###############################################################################
# New failures detected after GA or caused by changes pushed after GA of 11.

# SapMachine 2019-02-16
# javax.crypto.AEADBadTagException: Tag mismatch!
# SapMachine 2019-08-29 This test got excluded with JDK-8224991. Backported to 11.0.5, remove this entry after release of 11.0.5.
#
#javax/net/ssl/ServerName/SSLEngineExplorerMatchedSNI.java                    8212096 generic-all

# SapMachine 2019-07-12
# Issue with certain font configurations. There is already an exclusion of this test for
# solaris and mac in the generic exclusion list. Excluding this test for linux now as well.
# https://bugs.openjdk.java.net/browse/JDK-8231495 to track resolution.
# https://bugs.openjdk.java.net/browse/JDK-8223869 for exclusion request.
# SapMachine 2019-10-02 Pushed exclusion to jdk/jdk, requested backport to 11.0.6 and 13.0.2
#java/awt/FontMetrics/MaxAdvanceIsMax.java                            8221305,8231495 solaris-all,macosx-all,linux-all

###############################################################################
# New failures detected after GA of 11.0.3 (e.g. seen only in jdk11u-dev after branching 11.0.3 to jdk11u)

# SapMachine 2019-06-17
# java.lang.Exception: Failed for font java.awt.Font[family=Dialog,name=MS Gothic,style=bold,size=30]
#
#
# SapMachine 2019-10-09 I believe this is caused by outdated libfreetype versions and hence fixed by using configure option --with-freetype=bundled everywhere
#java/awt/font/Outline/OutlineInvarianceTest.java                                     linux-s390x

# SapMachine 2019-06-28
#
# java.lang.AssertionError at java.desktop/sun.awt.shell.Win32ShellFolder2$4.call(Win32ShellFolder2.java:440)
# Seen in 11, 13, 14.
#
javax/swing/JFileChooser/4847375/bug4847375.java                                     windows-x64

# SapMachine 2019-06-28
# Seen in 11, 13, 14. timeouts.
#
#
# Most likely fixed by https://bugs.openjdk.java.net/browse/JDK-8227435.
# SapMachine 2019-10-02: Fix pushed to JDK14, 13.0.2 and 11.0.6
#sun/jvmstat/monitor/MonitoredVm/MonitorVmStartTerminate.java                 8227435 windows-x64

# SapMachine 2019-06-28
# timeout on ppc in 11 only.
#
#
# SapMachine 2019-09-24 Re-enabled test in jdk/jdk and jdk11u-dev because Lutz is heavily testing.
jdk/jfr/event/compiler/TestCodeSweeper.java                                          linux-ppc64,linux-ppc64le

# SapMachine 2019-06-28
#
# java.lang.RuntimeException: Could not find root object
#
jdk/jfr/event/oldobject/TestLargeRootSet.java                                8205651 generic-all

# SapMachine 2019-07-15
# Issue started occuring in 06/2019 but not related to JDK updates
#
#
java/awt/print/PrinterJob/SameService.java                                   8229023 linux-s390x

# SapMachine 2019-07-16
# Exception in thread "main" java.lang.RuntimeException: Test failed for - cpu:getCpuSystemUsage, expected [2], got [2]
#
#
# SapMachine 2019-10-02 Fixed by JDK-8227642 in jdk and JDK13. Should be downported (along with 8228434) to 11.0.6.
#jdk/internal/platform/docker/TestSystemMetrics.java                          8227642 linux-ppc64le,linux-s390x

# SapMachine 2019-07-18
# javax.net.ssl.SSLException: The status_request_v2 extension is inconsistent with the expected result: expected = true, actual = false
# we see this sporadically on rs6000_64 - why? Adding this entry but commented out, for reference.
#
#javax/net/ssl/Stapling/StapleEnableProps.java                                        aix-all

# SapMachine 2019-07-17
# java.lang.NumberFormatException: For input string: "18446744073709551615"
#
#
# https://bugs.openjdk.java.net/browse/JDK-8228585
# SapMachine 2019-08-08: Change JDK-8228585 pushed to 11.0.5, 13 and 14.
#
# SapMachine 2019-08-08: There seems to be another issue: memory:getMemoryUsage, expected [23040819200], got [23061266432]
#
#
# https://bugs.openjdk.java.net/browse/JDK-8229284
# SapMachine 2019-09-23: Change JDK-8229284 already pushed to jdk/jdk. Working on backports to jdk13 and 11.
#jdk/internal/platform/cgroup/TestCgroupMetrics.java                          8229284 linux-all

###############################################################################
# New failures detected after GA of 11.0.4 (e.g. seen only in jdk11u-dev after branching 11.0.4 to jdk11u)

# SapMachine 2019-07-19
# java.lang.RuntimeException: Total safepoint time illegal value: 0 ms (MIN = 1; MAX = 9223372036854775807)
# Occurs in JDK13 since 2019-02.
# We didn't see this in 11 yet, only 13, 14; but it's broken as well.
#
#
# SapMachine 2019-10-02 Part of jdk/jdk, jdk 13.0.0, jdk 11.0.5
#sun/management/HotspotRuntimeMBean/GetTotalSafepointTime.java                8228658 linux-s390x

# SapMachine 2019-08-01
# Appears in 11, 13, 14. In 11 not seen for quite some time, but failures with the same error in the database.
#
#
#
java/awt/FontClass/FontSize1Test.java                                                macosx-all

###############################################################################
# Tests known to be failing in OpenJDK when JDK 12 was released (3/2019)

# SapMachine 2019-02-08
# Sporadic failure: IllegalStateException: Test FAILED: Unexpected Maximum Pool Size Overflow!
# SapMachine 2019-06-28 Check whether fixed
#javax/management/monitor/StartStopTest.java                                          windows-all

# SapMachine 2019-02-08
# SSLHandshakeException: Received fatal alert: handshake_failure
# SapMachine GL 2019-06-28 Check whether fixed
#sun/management/jmxremote/bootstrap/RmiSslBootstrapTest.sh                            linux-x64

# SapMachine 2019-02-08
# times out.
com/sun/jndi/ldap/LdapDnsProviderTest.java                                           macosx-all

# SapMachine 2019-02-08
# Can't delete /priv/jvmtests/.../javax/security/auth/Subject/DoAs/NestedActions.d
# SapMachine 2019-07-12 Still failing
javax/security/auth/Subject/DoAs.java                                                macosx-all

# SapMachine 2019-02-08
# RuntimeException: getBundle("UnreadableRB") doesn't throw class java.io.IOException
# SapMachine 2019-07-12 Still failing
java/util/ResourceBundle/Control/MissingResourceCauseTestRun.java                    windows-all

# SapMachine 2019-02-08
# Sporadic: OutOfMemoryError: Compressed class space
# SapMachine 2019-06-28 Check whether fixed
#java/lang/management/MemoryMXBean/LowMemoryTest2.sh                                  linux-s390x,windows-all

# SapMachine 2019-02-08
# Both only failing on a certain box. Do we need to fix the machine?
# SapMachine 2019-07-12 Enabling both tests again
# RuntimeException: Expected message not received, Receive timed out
#java/net/MulticastSocket/Promiscuous.java                                            macosx-all
# SocketTimeoutException: Receive timed out
#java/net/MulticastSocket/SetOutgoingIf.java                                          macosx-all

# SapMachine 2019-02-08
# javax.naming.CommunicationException: DNS error [Root exception is SocketTimeoutException: Receive timed out] ...
# Mac is in the central exclude list.
com/sun/jndi/dns/ConfigTests/PortUnreachable.java                            7164518 macosx-all,aix-ppc64

# SapMachine 2019-02-08
# assertEquals: expected -1 to equal 53332
tools/jlink/JLinkReproducibleTest.java                                               aix-ppc64

# SapMachine 2019-02-08
# java.lang.StackOverflowError
java/lang/String/concat/WithSecurityManager.java                                     aix-ppc64
# NoSuchElementException: No value present at java.base/java.util.Optional.get
java/net/SocketPermission/SocketPermissionTest.java                                  aix-ppc64
# NoSuchElementException: at java.base/java.util.Spliterators$1Adapter.next()
java/nio/channels/DatagramChannel/BasicMulticastTests.java                           aix-ppc64
# RuntimeException: IOException expected at DeleteOnClose.runTest(DeleteOnClose.java:92)
java/nio/file/Files/DeleteOnClose.java                                               aix-ppc64
# RuntimeException at SBC.noFollowLinksTests(SBC.java:238)
java/nio/file/Files/SBC.java                                                         aix-ppc64
# Happens sporadic:
# SSLHandshakeException: PKIX path validation failed: CertPathValidatorException: Could not determine revocation status
javax/net/ssl/Stapling/SSLEngineWithStapling.java                                    aix-ppc64

# SapMachine 2019-02-16
# timeout, on be a lot, on le once.
java/nio/channels/FileChannel/CleanerTest.java                                       linux-ppc64,linux-ppc64le

###############################################################################
# Failing new tests, unsupported new features in jdk13

# SapMachine 2019-02-21
# All crash reproducible on one test machine. SIGSEGV [libucrypto.so.1+0xb5a90]  ucrypto_digest_update+0x4
# SapMachine 2019-10-09 See if this still occurs.
#java/net/httpclient/DigestEchoClientSSL.java                                         solaris-sparcv9
#java/net/httpclient/ProxyAuthDisabledSchemesSSL.java                                 solaris-sparcv9
#sun/security/tools/jarsigner/PreserveRawManifestEntryAndDigest                       solaris-sparcv9
#sun/security/tools/keytool/KeyToolTest.java                                          solaris-sparcv9

# SapMachine 2019-07-17
# Occurring since about 2019-05. Seems to have to do with a missing font in the Windows installation.
# There's already an OpenJDK bug open for this: https://bugs.openjdk.java.net/browse/JDK-8223935
# Exluding for now.
java/awt/font/WindowsIndicFonts.java                                         8223935 windows-all

# SapMachine 2019-07-19
# java.io.IOException: No route to host
#
# SapMachine 2019-08-01: adding mac. Oracle excluded this on mac due to 7122846.
# SapMachine 2019-10-02 8229706 was pushed to jdk/jdk and 13.0.2
#java/net/MulticastSocket/NoLoopbackPackets.java                              8229706 aix-all,macosx-all

# SapMachine 2019-08-01
# Asserts in TestShutdownEvent.validateStackTrace().
#
#
# SapMachine 2019-10-02 Fix for 8219082 has been pushed to jdk/jdk and jdk13u (13.0.2)
#jdk/jfr/event/runtime/TestShutdownEvent.java                                 8219082 linux-all

# SapMachine 2019-08-02
# RuntimeException: assertGreaterThanOrEqual: expected 1 >= 2
# Seen only on linuxx86_64, ... . Maybe a specific issue on that box?
#
#
# SapMachine 2019-10-02 Excluded by 8230115 and backported to 13.0.2
#jdk/jfr/event/runtime/TestNetworkUtilizationEvent.java               8228990,8229370 linuxx86_64

# SapMachine 2019-08-08
# We see this issue occuring for a long time already in 13 and 14.
# Another one of these flaky font things??
#
java/awt/font/FontNames/FCCompositeTest.java                                         linux-all

# SapMachine 2019-08-09
# This test fails only on ..., probably a configuration issue
#
#
java/nio/file/WatchService/LotsOfCloses.java                                         linux-s390x

# SapMachine 2019-08-29
# GC overhead limit exceeded, occurs very often
#
# Created JBS issue: https://bugs.openjdk.java.net/browse/JDK-8230349
jdk/jfr/event/gc/detailed/TestStressAllocationGCEventsWithParallel.java      8230349 macosx-all

# SapMachine 2019-08-29
# We see errors in jdk/jdk (14) and recently in 11 as well. So, it must be introduced
# by some change that had been backported.
# Excluding this test because Oracle already opened a JBS item and seems to be workin on it.
#sun/tools/jhsdb/JShellHeapDumpTest.java                                      8228625 generic-all

# SapMachine 2019-09-09
# Maybe related to new Socket Impl
#
#
# First occurence on 2019-06-04
#java/net/Socket/asyncClose/Race.java                                                 aix-all

###############################################################################
# New failures detected after GA of 13

# SapMachine 2019-09-26
# This test is failing on our new Ubuntu 18.04 systems for ppcle.
# Currently only affecting 13 and 14
#
#
javax/swing/plaf/basic/BasicGraphicsUtils/8132119/bug8132119.java                    linux-ppc64le

# SapMachine 2019-10-04
# Seems a certificate got revoked. Opened a JBS bug and adding exclusion here for the time being.
# https://bugs.openjdk.java.net/browse/JDK-8231887
# SapMachine 2019-10-10 Fix pushed to jdk/jdk. Requesting all backports.
#security/infra/java/security/cert/CertPathValidator/certification/ComodoCA.java 8231887 generic-all

###############################################################################
# Tests known to be failing in SapMachine due to SapMachine specific setup.

# SapMachine 2018-10-05
# This test opens as many sockets as possible and fails after a timeout.
# When running in concurrency mode, all tests that need a socket and run in
# parallel to this test will fail.
java/nio/channels/AsyncCloseAndInterrupt.java                                        generic-all

# SapMachine 2019-01-31 These fail on MacOS in the SapMachine CI infrastructure.
# Need to check how this can be fixed.
com/sun/jdi/AccessSpecifierTest.java                                                 macosx-all
com/sun/jdi/AfterThreadDeathTest.java                                                macosx-all
com/sun/jdi/ArrayRangeTest.java                                                      macosx-all
com/sun/jdi/ConstantPoolInfo.java                                                    macosx-all
com/sun/jdi/CountFilterTest.java                                                     macosx-all
com/sun/jdi/EarlyReturnNegativeTest.java                                             macosx-all
com/sun/jdi/EarlyReturnTest.java                                                     macosx-all
com/sun/jdi/FieldWatchpoints.java                                                    macosx-all
com/sun/jdi/FramesTest.java                                                          macosx-all
com/sun/jdi/InstanceFilter.java                                                      macosx-all
com/sun/jdi/InterfaceMethodsTest.java                                                macosx-all
com/sun/jdi/InvokeTest.java                                                          macosx-all
com/sun/jdi/LocalVariableEqual.java                                                  macosx-all
com/sun/jdi/LocationTest.java                                                        macosx-all
com/sun/jdi/ModificationWatchpoints.java                                             macosx-all
com/sun/jdi/MonitorEventTest.java                                                    macosx-all
com/sun/jdi/MonitorFrameInfo.java                                                    macosx-all
com/sun/jdi/NullThreadGroupNameTest.java                                             macosx-all
com/sun/jdi/PopAndStepTest.java                                                      macosx-all
com/sun/jdi/PopAsynchronousTest.java                                                 macosx-all
com/sun/jdi/ReferrersTest.java                                                       macosx-all
com/sun/jdi/RequestReflectionTest.java                                               macosx-all
com/sun/jdi/ResumeOneThreadTest.java                                                 macosx-all
com/sun/jdi/SourceNameFilterTest.java                                                macosx-all
com/sun/jdi/VarargsTest.java                                                         macosx-all
com/sun/jdi/Vars.java                                                                macosx-all
com/sun/jdi/redefineMethod/RedefineTest.java                                         macosx-all
com/sun/jdi/sde/MangleTest.java                                                      macosx-all
com/sun/jdi/sde/TemperatureTableTest.java                                            macosx-all

# SapMachine 2019-01-30
# This test fails on linux-ppc64le and linux-ppc64. Probably due to resource constraints.
java/util/Base64/TestEncodingDecodingLength.java                                     linux-ppc64le,linux-ppc64

# SapMachine 2019-05-20
# We have problems with this test in our CI env on linux-x64. Excluding for now.
java/lang/ProcessHandle/OnExitTest.java                                              linux-x64
